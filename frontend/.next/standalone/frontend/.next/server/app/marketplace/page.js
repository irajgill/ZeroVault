(()=>{var e={id:240,ids:[240]};e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7839:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},9048:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});r(9651),r(5495),r(7629),r(2523);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),o=r(5231),l={};for(const m in o)["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(m)<0&&(l[m]=()=>o[m]);r.d(t,l);const c=["",{children:["marketplace",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9651)),"/home/raj/zkDataVault/frontend/src/app/marketplace/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,5495)),"/home/raj/zkDataVault/frontend/src/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"/home/raj/zkDataVault/frontend/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,2523)),"/home/raj/zkDataVault/frontend/src/app/not-found.tsx"]}],d=["/home/raj/zkDataVault/frontend/src/app/marketplace/page.tsx"],u="/marketplace/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/marketplace/page",pathname:"/marketplace",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2532:(e,t,r)=>{Promise.resolve().then(r.bind(r,5598))},5598:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j,dynamic:()=>b});var s=r(326),a=r(7577),i=r(659),n=r(1399),o=r(9609),l=r(4295),c=r(8025),d=r(413),u=r(7062),p=r(1223),x=r(6796),m=r(5685),h=r(9807),g=r(6557);const y=(0,g.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),f=(0,g.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var w=r(763);const b="force-dynamic";function j(){const{datasets:e,isLoading:t,error:r,refetch:g}=(0,i.ZP)(),[b,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(0),{executeTransaction:k,waitForTransaction:_,account:P}=(0,c.Z)(),{downloading:q,error:S,plaintext:D,filename:C,contentType:Z,downloadAndDecrypt:E,reset:z}=(0,m.Z)(),L=P?.address||"",{attestations:M}=(0,h.Z)(L||void 0),[A,T]=(0,a.useState)([]),[V,I]=(0,a.useState)(null),[B,R]=(0,a.useState)(void 0),[G,F]=(0,a.useState)(null),[U,X]=(0,a.useState)(!1),K=(0,a.useMemo)((()=>(e||[]).filter((e=>{const t=Number(e.quality_score||0)>=(v||0),r=!b||e.name.toLowerCase().includes(b.toLowerCase())||e.description.toLowerCase().includes(b.toLowerCase());return t&&r}))),[e,b,v]),W=((0,a.useMemo)((()=>e?.length?e.reduce(((e,t)=>e+Number(t.price||0)),0):0),[e]),(0,a.useMemo)((()=>{if(!e?.length)return 0;const t=e.map((e=>Number(e.quality_score||0)));return Math.round(t.reduce(((e,t)=>e+t),0)/t.length)}),[e]));return(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsxs)("header",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col items-start justify-between gap-3 sm:flex-row sm:items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"ZeroVault marketplace"}),s.jsx("p",{className:"mt-1 text-sm text-gray-300",children:"Browse encrypted datasets with on-chain provenance. Every purchase runs through Walrus, Seal, Nautilus, and Sui."})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 justify-start sm:justify-end",children:[s.jsx("input",{type:"text",placeholder:"Search datasets...",value:b,onChange:e=>j(e.target.value),className:"rounded-md border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"inline-flex items-center gap-1 rounded-full border border-white/10 bg-white/5 px-1.5 py-1 text-[11px] text-gray-200",children:[s.jsx("span",{className:"hidden sm:inline text-gray-400 mr-1",children:"Quality:"}),[0,70,80,90].map((e=>s.jsx("button",{type:"button",onClick:()=>N(e),className:"rounded-full px-2 py-0.5 transition "+(v===e?"bg-blue-500 text-white":"bg-transparent text-gray-200 hover:bg-white/10"),children:0===e?"All":`${e}+`},e)))]}),(0,s.jsxs)("button",{type:"button",onClick:()=>g(),className:"inline-flex items-center gap-1 rounded-md border border-white/10 bg-white/5 px-3 py-1.5 text-sm text-white hover:bg-white/10",children:[s.jsx(y,{className:"h-4 w-4"}),"Refresh"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-xs text-gray-300 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-white/10 bg-white/5 p-3 flex items-center gap-2",children:[s.jsx(f,{className:"h-4 w-4 text-blue-300"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold text-gray-100",children:"Listings"}),(0,s.jsxs)("p",{children:[e?.length??0," total datasets"]})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-white/10 bg-white/5 p-3 flex items-center gap-2",children:[s.jsx(w.Z,{className:"h-4 w-4 text-emerald-300"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold text-gray-100",children:"Average quality"}),(0,s.jsxs)("p",{children:[W||0," / 100 (Nautilus score)"]})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-white/10 bg-white/5 p-3 flex items-center gap-2",children:[s.jsx("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-500 text-xs font-bold text-white",children:"ZV"}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-semibold text-gray-100",children:"Real purchases"}),s.jsx("p",{children:"Pay with Sui PTBs; proofs verified on-chain."})]})]})]}),V?s.jsx("div",{className:"sticky top-4 z-10",children:s.jsx(x.Z,{status:"pending"===V?"pending":"success"===V?"success":"failed",digest:B,message:G||("pending"===V?"Processing your purchase on Sui\u2026":"Purchase completed. This is a real Sui transaction.")})}):null]}),t?s.jsx("div",{className:"mt-4",children:s.jsx(o.Z,{message:"Loading datasets..."})}):null,r?s.jsx("div",{className:"mt-4",children:s.jsx(l.Z,{error:r,onRetry:()=>g()})}):null,(0,s.jsxs)("section",{className:"mt-2 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide text-gray-200",children:"Available datasets"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["Showing ",K.length," of ",e?.length??0]})]}),s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:K?.map((e=>{const t=A.includes(e.id),r=M.length>0&&e.creator&&L&&e.creator.toLowerCase()===L.toLowerCase()?M[0].domain:void 0;return s.jsx(n.Z,{id:e.sui_object_id||e.id,name:e.name,description:e.description,creator:e.creator,price:e.price,qualityScore:Number(e.quality_score||0),blobId:e.blob_id,verifiedDomain:r,onPurchase:()=>async function(e){if(!U)throw new Error("Wallet not ready");if(!P?.address)throw new Error("Connect your wallet to purchase");if(!d.lD.package||!d.lD.marketplace)throw new Error("Marketplace contract IDs are not configured (NEXT_PUBLIC_PACKAGE_ID / NEXT_PUBLIC_MARKETPLACE_ID)");const t=(0,p.z8)(await(0,p.Mp)(e.id)),r=BigInt(e.price||"0");if(r<=0n)throw new Error("Invalid dataset price");const s=(0,p.z8)(d.lD.marketplace),a=(0,p.z8)(d.SL),i=new u.Y,[n]=i.splitCoins(i.gas,[r]);i.moveCall({target:`${(0,p.z8)(d.lD.package)}::marketplace::purchase_dataset`,arguments:[i.object(s),i.pure.address(t),n,i.pure.address(a)]});try{I("pending"),F(null),R(void 0);const t=await k(i);R(t);const r=await _(t);I(r?"success":"failed"),r&&T((t=>t.includes(e.id)?t:[...t,e.id])),await g()}catch(o){I("failed"),F(o.message||String(o))}}(e),onDownload:t?()=>async function(e){await E(e.id)}(e):void 0},e.id)}))}),t||r||0!==K.length?null:s.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"No datasets match your filters yet."})]}),S?s.jsx("div",{className:"mt-4",children:s.jsx(l.Z,{error:S,onRetry:z})}):null,D?(0,s.jsxs)("div",{className:"mt-4 rounded-md border border-white/10 bg-white/5 p-3",children:[s.jsx("p",{className:"mb-1 text-xs text-gray-300",children:"Decrypted preview (first 256 bytes, UTF-8):"}),s.jsx("pre",{className:"max-h-40 overflow-auto whitespace-pre-wrap break-all text-xs text-gray-100",children:(new TextDecoder).decode(D.subarray(0,256))})]}):null]})}},9651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,dynamic:()=>a});var s=r(8570);const a=(0,s.createProxy)(String.raw`/home/raj/zkDataVault/frontend/src/app/marketplace/page.tsx#dynamic`),i=(0,s.createProxy)(String.raw`/home/raj/zkDataVault/frontend/src/app/marketplace/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=t.X(0,[42,538,8,519],(()=>{return e=9048,t(t.s=e);var e}));module.exports=r})();