(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{695:function(e,t,a){Promise.resolve().then(a.bind(a,7994))},7994:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w},dynamic:function(){return v}});var r=a(7437),s=a(2265),l=a(9642),i=a(5368),o=a(3976),n=a(5281),c=a(8855),d=a(5820);var u=a(3448),p=a(6869),m=a(2089),x=a(522),h=a(4732);function f(e){const t=e.startsWith("0x")?e.slice(2):e,a=[];for(let r=0;r<t.length;r+=2)a.push(parseInt(t.substr(r,2),16));return a}var g=function(){const[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(null),[l,i]=(0,s.useState)(null),{executeTransaction:n,waitForTransaction:c}=(0,h.Z)(),d=(0,s.useCallback)((async(e,a)=>{t(!0),r(null),i("Generating authenticity proof");try{const t=await p.Z.post("".concat(o.z0,"/api/proof/generate"),{datasetHash:e,creatorPrivateKey:a,creationTimestamp:Date.now()},{timeout:o.LS.PROOF_GENERATION});return i("Proof generated"),t.data}catch(n){var s,l;const e=(null===n||void 0===n||null===(l=n.response)||void 0===l||null===(s=l.data)||void 0===s?void 0:s.error)||(null===n||void 0===n?void 0:n.message)||"Failed to generate proof";throw r(e),i("Error"),new Error(e)}finally{t(!1)}}),[]),u=(0,s.useCallback)((async(e,a,s)=>{t(!0),r(null),i(o.Ie?"Bypassing proof verification (dev mode)":"Verifying proof");try{if(o.Ie)return!0;const{data:t}=await p.Z.post("".concat(o.z0,"/api/proof/verify"),{proof:e,publicInputs:a,circuitType:s},{timeout:3e4}),r=Boolean(null===t||void 0===t?void 0:t.isValid);return i(r?"Proof valid":"Proof invalid"),r}catch(c){var l,n;const e=(null===c||void 0===c||null===(n=c.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.error)||(null===c||void 0===c?void 0:c.message)||"Failed to verify proof";return r(e),i("Error"),!1}finally{t(!1)}}),[]),g=(0,s.useCallback)((async(e,a,s)=>{t(!0),r(null),i(o.Ie?"Skipping on-chain proof submission (dev mode)":"Preparing on-chain submission");try{var l,d;if(o.Ie)return"0xDEV_BYPASS_ZK_PROOF";const t=await p.Z.post("".concat(o.z0,"/api/proof/prepare-onchain"),{proof:e,publicInputs:a,circuitType:s},{timeout:2e4}),r=null===(l=t.data)||void 0===l?void 0:l.proofBytesHex,u=null===(d=t.data)||void 0===d?void 0:d.publicInputsBytesHex;if(!r||!u)throw new Error("Backend did not return prepared byte arrays");if(!o.lD.package||!o.lD.vk||!o.lD.proof_registry)throw new Error("Missing CONTRACT_IDS (package/vk/proof_registry)");const h=new m.Y,g=f(r),b=f(u),y=x.$5.vector(x.$5.u8()).serialize(Uint8Array.from(g)).toBytes(),v=x.$5.vector(x.$5.u8()).serialize(Uint8Array.from(b)).toBytes();h.moveCall({target:"".concat(o.lD.package,"::zk_verifier::verify_data_authenticity"),arguments:[h.object(o.lD.vk),h.pure(v),h.pure(y),h.object(o.lD.proof_registry)]}),i("Submitting transaction");const w=await n(h);return i("Waiting for finality"),await c(w),i("Submitted"),w}catch(g){var u,h;const e=(null===g||void 0===g||null===(h=g.response)||void 0===h||null===(u=h.data)||void 0===u?void 0:u.error)||(null===g||void 0===g?void 0:g.message)||"Failed to submit proof on-chain";throw r(e),i("Error"),new Error(e)}finally{t(!1)}}),[n,c]);return(0,s.useMemo)((()=>({loading:e,error:a,status:l,generateProof:d,verifyProof:u,submitProofToChain:g})),[e,a,l,d,u,g])},b=a(8462),y=a(2023);const v="force-dynamic";function w(){const e=(0,i.t)(),t=((null===e||void 0===e?void 0:e.address)||"").toLowerCase(),[a,m]=(0,s.useState)(null),[x,h]=(0,s.useState)(""),[f,v]=(0,s.useState)(""),[w,j]=(0,s.useState)("0"),[N,S]=(0,s.useState)(null),[k,_]=(0,s.useState)(null),[C,I]=(0,s.useState)(null),[P,Z]=(0,s.useState)(""),[E,D]=(0,s.useState)(null),{upload:z,uploading:F,error:T}=function(){const[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(null),[l,i]=(0,s.useState)(0),o=(0,s.useCallback)((async e=>{t(!0),r(null),i(5);try{const t=await(0,d.Qt)(e);return i(100),t}catch(a){const e=a.message||"Upload failed";throw r(e),a}finally{t(!1)}}),[]),n=(0,s.useCallback)((()=>{t(!1),r(null),i(0)}),[]);return(0,s.useMemo)((()=>({uploading:e,error:a,progress:l,upload:o,reset:n})),[e,a,l,o,n])}(),{loading:V,error:A,status:B,generateProof:M,verifyProof:O,submitProofToChain:R}=g(),[K,U]=(0,s.useState)("idle"),[q,$]=(0,s.useState)(null),W=(0,s.useCallback)((e=>{e.length>0&&m(e[0])}),[]),{getRootProps:H,getInputProps:L,isDragActive:Y,fileRejections:G}=(0,l.uI)({onDrop:W,maxSize:o.Tb,multiple:!1}),J=(0,s.useMemo)((()=>{var e;if(!G.length)return null;const t=G[0];return(null===(e=t.errors)||void 0===e?void 0:e.length)?t.errors[0].message:"File rejected"}),[G]),Q=(0,s.useCallback)((e=>{const t=(e||"").trim();if(!t)return"123456";if(/^0x[0-9a-fA-F]+$/.test(t))return t;if(/^[0-9]+$/.test(t))return t;if(/^[0-9a-fA-F]+$/.test(t))return"0x"+t;throw new Error("Creator key must be decimal or hex (optionally 0x-prefixed).")}),[]),X=(0,s.useCallback)((async()=>{if(!a)return;D(null),_(null),S(null),I(null),$(null),U("uploading");const e=await a.arrayBuffer(),r=await(0,u.Mp)(e);try{var s,l,i,n,c,d,m;const u={file:await new Promise((t=>{const r=new FileReader;r.onloadend=()=>t(r.result.split(",").pop()||""),r.readAsDataURL(new File([e],a.name))})),originalFilename:a.name,contentType:a.type||"application/octet-stream",metadata:{name:x,description:f,price:String(1e9*Number(w||"0")),creator:t||void 0}},g={"content-type":"application/json"};t&&(g["x-creator-address"]=t);const b=await p.Z.post("".concat(o.z0,"/api/upload/dataset"),u,{headers:g,timeout:6e4}),y=null===(s=b.data)||void 0===s?void 0:s.dataset_id;$({datasetId:y,blobId:null===(l=b.data)||void 0===l?void 0:l.blob_id,sealPolicyId:null===(i=b.data)||void 0===i?void 0:i.seal_policy_id,uploadSize:null===(n=b.data)||void 0===n?void 0:n.upload_size,storedSize:null===(c=b.data)||void 0===c?void 0:c.stored_size,qualityScore:"number"===typeof(null===(d=b.data)||void 0===d?void 0:d.quality_score)?b.data.quality_score:void 0,isValid:"boolean"===typeof(null===(m=b.data)||void 0===m?void 0:m.is_valid)?b.data.is_valid:void 0}),U("proving");let v="123456";try{v=Q(P)}catch(h){return D(h.message),void U("error")}const j=await M(r,v);I({proof:j.proof,publicInputs:j.publicInputs});if(!(await O(j.proof,j.publicInputs,"data_authenticity")))throw U("error"),new Error("Local proof verification failed");_("pending"),U("submitting");const N=await R(j.proof,j.publicInputs,"data_authenticity");S(N),_("success"),U("complete")}catch(h){U("error"),D(h.message||"Upload & proof flow failed")}}),[a,x,f,w,t,P,Q,M,O,R]);return(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Create a ZeroVault dataset"}),(0,r.jsx)("p",{className:"mt-1 text-gray-300",children:"Encrypt any file with Seal, store it on Walrus as an encrypted blob, and mint a ZK-backed proof of origin on Sui."}),(0,r.jsxs)("div",{...H(),className:"mt-6 rounded-md border-2 border-dashed p-8 text-center transition ".concat(Y?"border-blue-500 bg-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"),children:[(0,r.jsx)("input",{...L()}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:Y?"Drop the file here...":"Drag & drop a file here, or click to select"}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-gray-400",children:["Max ",Math.round(o.Tb/1048576),"MB \xb7 Any file type (images, CSV, JSON, binaries, archives, ...)"]})]}),a?(0,r.jsxs)("div",{className:"mt-4 text-sm text-gray-300",children:["Selected: ",(0,r.jsx)("span",{className:"font-medium text-white",children:a.name})," (",Math.round(a.size/1024)," KB)"]}):null,J?(0,r.jsx)(n.Z,{error:J}):null,(0,r.jsxs)("div",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-300",children:"Name"}),(0,r.jsx)("input",{type:"text",className:"mt-1 w-full rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"High-quality financial time-series, medical images, ...",value:x,onChange:e=>h(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-300",children:"Price (SUI)"}),(0,r.jsx)("input",{type:"number",min:"0",step:"0.001",className:"mt-1 w-full rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.0",value:w,onChange:e=>j(e.target.value)})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-300",children:"Description"}),(0,r.jsx)("textarea",{className:"mt-1 w-full rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe your dataset, its source, licensing, and ideal use-cases...",rows:4,value:f,onChange:e=>v(e.target.value)})]}),(0,r.jsxs)("div",{className:"mt-6 rounded-lg border border-yellow-500/30 bg-yellow-500/5 p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-yellow-200",children:"Advanced ZK creator binding (optional)"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-yellow-100/90",children:"ZeroVault can bind each dataset to a hidden creator-specific secret inside the ZK proof. In this demo, you may enter any numeric or hex value. In a production deployment this would be derived from a secure key manager or wallet. Do not paste real wallet private keys here."}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("label",{className:"block text-sm text-gray-200",children:"Creator binding secret"}),(0,r.jsx)("input",{type:"password",className:"mt-1 w-full rounded-md border border-yellow-500/40 bg-black/40 px-3 py-2 text-sm text-gray-100 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",placeholder:"Optional \u2014 leave blank to use a demo secret",value:P,onChange:e=>Z(e.target.value)})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex items-center gap-3",children:[(0,r.jsxs)("button",{type:"button",disabled:!a||V||"uploading"===K||"proving"===K||"submitting"===K,onClick:()=>X().catch((()=>{})),className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white disabled:opacity-50 hover:bg-blue-500",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4"}),"idle"===K||"error"===K?"Start Upload & Prove":"Working..."]}),t?(0,r.jsxs)("span",{className:"text-xs text-gray-400",children:["Connected as ",(0,r.jsx)("span",{className:"font-medium text-gray-200",children:(0,u.FP)(t)})]}):(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"Connect your wallet to mint provenance on Sui."})]}),(0,r.jsxs)("div",{className:"mt-6 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-300",children:"ZeroVault pipeline"}),(0,r.jsxs)("ol",{className:"mt-3 space-y-2 text-sm text-gray-200",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"mt-0.5 flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-semibold ".concat("uploading"===K||"proving"===K||"submitting"===K||"complete"===K?"bg-blue-600 text-white":"bg-white/10 text-gray-300"),children:"1"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Encrypt & upload"})," ",(0,r.jsx)("span",{className:"text-gray-300",children:"\u2014 Your file is sealed with Seal and stored as an encrypted blob on Walrus."})]})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"mt-0.5 flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-semibold ".concat("proving"===K||"submitting"===K||"complete"===K?"bg-purple-600 text-white":"bg-white/10 text-gray-300"),children:"2"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Run ZK proof"})," ",(0,r.jsx)("span",{className:"text-gray-300",children:"\u2014 Circom + Groth16 generate a proof that you own this exact dataset without revealing it."})]})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"mt-0.5 flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-semibold ".concat("submitting"===K||"complete"===K?"bg-emerald-600 text-white":"bg-white/10 text-gray-300"),children:"3"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Verify on-chain"})," ",(0,r.jsx)("span",{className:"text-gray-300",children:"\u2014 Sui smart contracts verify the proof and anchor your dataset's provenance."})]})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"mt-0.5 flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-semibold ".concat("complete"===K?"bg-pink-600 text-white":"bg-white/10 text-gray-300"),children:(0,r.jsx)(y.Z,{className:"h-3 w-3"})}),(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Mint ZeroVault entry"})," ",(0,r.jsx)("span",{className:"text-gray-300",children:"\u2014 Your dataset is ready to list and sell on the ZeroVault marketplace."})]})]})]}),(F||V||"idle"!==K)&&(0,r.jsx)("div",{className:"mt-4 flex items-center justify-between text-xs text-gray-400",children:(0,r.jsx)("span",{children:B||("complete"===K?"Pipeline complete":"Processing pipeline\u2026")})})]}),E?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(n.Z,{error:E})}):null,T?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(n.Z,{error:T})}):null,A?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(n.Z,{error:A})}):null,q?(0,r.jsxs)("div",{className:"mt-6 rounded-lg border border-white/10 bg-white/5 p-4 text-xs text-gray-200",children:[(0,r.jsx)("p",{className:"mb-2 font-semibold text-gray-100",children:"Upload summary"}),q.blobId?(0,r.jsxs)("p",{className:"mt-1",children:["Walrus blob: ",(0,r.jsx)("span",{className:"font-mono text-[11px]",children:q.blobId})]}):null,q.uploadSize?(0,r.jsxs)("p",{className:"mt-1",children:["Encrypted size: ",(0,u.td)(q.uploadSize)]}):null,"number"===typeof q.qualityScore?(0,r.jsxs)("p",{className:"mt-1",children:["Nautilus quality score:"," ",(0,r.jsxs)("span",{className:"font-semibold",children:[q.qualityScore,q.isValid?" (passes threshold)":""]})]}):null]}):null,k?(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(c.Z,{status:k,digest:N||void 0,message:"ZK proof transaction on Sui (real on-chain verification)"})}):null]})}}},function(e){e.O(0,[368,14,792,56,971,117,744],(function(){return t=695,e(e.s=t);var t}));var t=e.O();_N_E=t}]);